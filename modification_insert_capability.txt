MMM replace_function_class MMM
code_mod_defs.py
@@@@@@
replace_function_class
@@@@@@
def replace_function_class(file_path, target_path, new_code):
    """
    Replace a function or class in a file with new code using lexical chain support.
    If the target doesn't exist, insert it in the appropriate location.
    
    Args:
        file_path: Path to the Python file
        target_path: Target path like 'function_name' or 'ClassName.method_name'
        new_code: New function/class code to replace with
    """
    with open(file_path, 'r') as f:
        content = f.read()
    
    target_name, lexical_chain = parse_lexical_chain(target_path)
    
    # Try replacement first
    new_content = replace_block(content, new_code, target_name=target_name, lexical_chain=lexical_chain)
    
    # Check if replacement actually happened by comparing content
    if new_content == content:
        # Target not found, insert instead
        new_content = insert_block(content, new_code, target_name=target_name, lexical_chain=lexical_chain)

    with open(file_path, 'w') as f:
        f.write(new_content)
    
    logging.debug(f"Modified {target_path} in {file_path}")

